import { InlineKeyboard } from "grammy";
import { BotContext } from "../../types.ts";

// URL –∏–≥—Ä (–∑–∞–º–µ–Ω–∏ –Ω–∞ —Å–≤–æ–π –¥–æ–º–µ–Ω –∏–ª–∏ ngrok)
const GAME_URL = Deno.env.get("GAME_SERVER_URL") || "https://your-domain.com";

// –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –∏–≥—Ä
export async function handleGamesCallback(ctx: BotContext) {
  const keyboard = new InlineKeyboard()
    .webApp("üêç –ó–º–µ–π–∫–∞", `${GAME_URL}/snake`)
    .webApp("üß± –ê—Ä–∫–∞–Ω–æ–∏–¥", `${GAME_URL}/arkanoid`).row()
    .webApp("üèì –ü–∏–Ω–≥-–ü–æ–Ω–≥", `${GAME_URL}/pingpong`)
    .webApp("üê¶ Flappy Bird", `${GAME_URL}/flappybird`).row()
    .webApp("ü¶ñ T-Rex Runner", `${GAME_URL}/dino`)
    .webApp("üü¶ Tetris", `${GAME_URL}/tetris`).row()
    .webApp("üëæ Space Invaders", `${GAME_URL}/spaceinvaders`).row()
    .text("‚óÄÔ∏è –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é", "back_to_menu");

  await ctx.editMessageText(
    `=============================
    üéÆ <b>–ò–ì–†–û–í–û–ô –ó–ê–õ</b> üéÆ
=============================

<b>‚ú® –í—ã–±–µ—Ä–∏ –∏–≥—Ä—É –∏ –ø–æ–≥—Ä—É–∑–∏—Å—å –≤ –¥–µ–π—Å—Ç–≤–∏–µ!</b>

-----------------------------
<b>üåü –ö–õ–ê–°–°–ò–ö–ê</b>
-----------------------------

üêç <b>–ó–º–µ–π–∫–∞</b>
   ‚Ä¢ –ü—Ä–æ—Ö–æ–¥–∏ —Å–∫–≤–æ–∑—å —Å—Ç–µ–Ω—ã
   ‚Ä¢ –ü–ª–∞–≤–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è
   ‚Ä¢ –ù–µ–æ–Ω–æ–≤–∞—è –≥—Ä–∞—Ñ–∏–∫–∞
   ‚Ä¢ –°–≤–∞–π–ø-—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

üß± <b>–ê—Ä–∫–∞–Ω–æ–∏–¥</b>
   ‚Ä¢ 3 —Ç–∏–ø–∞ –±—É—Å—Ç–æ–≤
   ‚Ä¢ –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã ‚¨å
   ‚Ä¢ –ú—É–ª—å—Ç–∏–±–æ–ª ‚ö°
   ‚Ä¢ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∂–∏–∑–Ω–∏ ‚ù§

-----------------------------
<b>üî• –°–û–†–ï–í–ù–û–í–ê–ù–ò–Ø</b>
-----------------------------

üèì <b>–ü–∏–Ω–≥-–ü–æ–Ω–≥</b>
   ‚Ä¢ –ò–≥—Ä–∞–π –ø—Ä–æ—Ç–∏–≤ AI
   ‚Ä¢ –ü–µ—Ä–≤—ã–º –¥–æ 5 –æ—á–∫–æ–≤
   ‚Ä¢ –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è —Ñ–∏–∑–∏–∫–∞
   ‚Ä¢ –¢–∞—á-—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

üëæ <b>Space Invaders</b>
   ‚Ä¢ –ó–∞—â–∏—â–∞–π –ø–ª–∞–Ω–µ—Ç—É
   ‚Ä¢ –í–æ–ª–Ω—ã –≤—Ä–∞–≥–æ–≤
   ‚Ä¢ –ë–æ–Ω—É—Å—ã –∏ —â–∏—Ç—ã
   ‚Ä¢ –†–µ—Ç—Ä–æ-–≥—Ä–∞—Ñ–∏–∫–∞

-----------------------------
<b>‚ö° –ê–†–ö–ê–î–´</b>
-----------------------------

ü¶ñ <b>T-Rex Runner</b>
   ‚Ä¢ –ë–µ–≥–∏ –∏ –ø—Ä—ã–≥–∞–π
   ‚Ä¢ –£–≤–µ–ª–∏—á–∏–≤–∞—é—â–∞—è—Å—è —Å–∫–æ—Ä–æ—Å—Ç—å
   ‚Ä¢ –î–µ–Ω—å/–Ω–æ—á—å —Ä–µ–∂–∏–º
   ‚Ä¢ –ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ä–∞–Ω–Ω–µ—Ä

üê¶ <b>Flappy Bird</b>
   ‚Ä¢ –õ–µ—Ç–∞–π –º–µ–∂–¥—É —Ç—Ä—É–±
   ‚Ä¢ –ü—Ä–æ—Å—Ç–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
   ‚Ä¢ –•–∞—Ä–¥–∫–æ—Ä–Ω—ã–π –≥–µ–π–º–ø–ª–µ–π
   ‚Ä¢ –†–µ–∫–æ—Ä–¥—ã

üü¶ <b>Tetris</b>
   ‚Ä¢ –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Ç–µ—Ç—Ä–∏—Å
   ‚Ä¢ –£–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
   ‚Ä¢ –°–∏—Å—Ç–µ–º–∞ –æ—á–∫–æ–≤
   ‚Ä¢ –õ–µ–≥–µ–Ω–¥–∞ —Å—Ä–µ–¥–∏ –∏–≥—Ä

-----------------------------

üéØ <b>–í—Å–µ –∏–≥—Ä—ã —Å:</b>
   ‚úì –ù–µ–æ–Ω–æ–≤–æ–π –∫–∏–±–µ—Ä–ø–∞–Ω–∫-–≥—Ä–∞—Ñ–∏–∫–æ–π
   ‚úì –ü–ª–∞–≤–Ω–æ–π –∞–Ω–∏–º–∞—Ü–∏–µ–π 60 FPS
   ‚úì –¢–∞–∫—Ç–∏–ª—å–Ω–æ–π –æ—Ç–¥–∞—á–µ–π
   ‚úì –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–º —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º

<b>üöÄ –í—ã–±–µ—Ä–∏ –∏–≥—Ä—É –Ω–∏–∂–µ!</b>`,
    { reply_markup: keyboard, parse_mode: "HTML" }
  );
}

// –ó–∞–ø—É—Å–∫ –∑–º–µ–π–∫–∏ (—Å—Ç–∞—Ä—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
export async function handleSnakeCallback(ctx: BotContext) {
  await handleGamesCallback(ctx);
}

// –ó–∞–ø—É—Å–∫ –∞—Ä–∫–∞–Ω–æ–∏–¥–∞ (—Å—Ç–∞—Ä—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
export async function handleArkanoidCallback(ctx: BotContext) {
  await handleGamesCallback(ctx);
}

// –ó–∞–≥–ª—É—à–∫–∏ –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
export async function handleSnakeMoveCallback(ctx: BotContext) {
  await ctx.answerCallbackQuery({ text: "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Web App –≤–µ—Ä—Å–∏—é!" });
}

export async function handleArkanoidMoveCallback(ctx: BotContext) {
  await ctx.answerCallbackQuery({ text: "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Web App –≤–µ—Ä—Å–∏—é!" });
}

// –¢–∞–±–ª–∏—Ü–∞ —Ä–µ–∫–æ—Ä–¥–æ–≤
export async function handleScoresCallback(ctx: BotContext) {
  const keyboard = new InlineKeyboard()
    .text("‚óÄÔ∏è –ù–∞–∑–∞–¥", "menu_games");

  await ctx.editMessageText(
    "üèÜ <b>–¢–∞–±–ª–∏—Ü–∞ —Ä–µ–∫–æ—Ä–¥–æ–≤</b>\n\n" +
    "üêç <b>–ó–º–µ–π–∫–∞:</b>\n" +
    "–°–∫–æ—Ä–æ –ø–æ—è–≤–∏—Ç—Å—è...\n\n" +
    "üß± <b>–ê—Ä–∫–∞–Ω–æ–∏–¥:</b>\n" +
    "–°–∫–æ—Ä–æ –ø–æ—è–≤–∏—Ç—Å—è...",
    { reply_markup: keyboard, parse_mode: "HTML" }
  );
}
