import { InlineKeyboard } from "grammy";
import { BotContext } from "../../types.ts";

// –ë–∞–∑–∞ –∞–Ω–µ–∫–¥–æ—Ç–æ–≤ –∏ —à—É—Ç–æ–∫
const jokes: Record<string, string[]> = {
  general: [
    "–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç –¥–æ–º–æ–π —Å –¥–≤—É–º—è –ø–∞–∫–µ—Ç–∞–º–∏ –º–æ–ª–æ–∫–∞.\n‚Äî –ó–∞—á–µ–º –¥–≤–∞?\n‚Äî –ê —Ç—ã —Å–∫–∞–∑–∞–ª–∞: ¬´–ö—É–ø–∏ –ø–∞–∫–µ—Ç –º–æ–ª–æ–∫–∞, –∞ –µ—Å–ª–∏ –±—É–¥—É—Ç —è–π—Ü–∞, —Ç–æ –¥–≤–∞¬ª. –Ø–π—Ü–∞ –±—ã–ª–∏.",
    "‚Äî –ü–æ—á–µ–º—É –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç—ã –ø—É—Ç–∞—é—Ç –•—ç–ª–ª–æ—É–∏–Ω –∏ –†–æ–∂–¥–µ—Å—Ç–≤–æ?\n‚Äî –ü–æ—Ç–æ–º—É —á—Ç–æ Oct 31 == Dec 25.",
    "–ñ–µ–Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–∞:\n‚Äî –°—Ö–æ–¥–∏ –≤ –º–∞–≥–∞–∑–∏–Ω, –∫—É–ø–∏ –±–∞—Ç–æ–Ω —Ö–ª–µ–±–∞. –ï—Å–ª–∏ –±—É–¥—É—Ç —è–π—Ü–∞ ‚Äî –≤–æ–∑—å–º–∏ –¥–µ—Å—è—Ç–æ–∫.\n–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç —Å 10 –±–∞—Ç–æ–Ω–∞–º–∏.\n‚Äî –¢—ã –∑–∞—á–µ–º —Å—Ç–æ–ª—å–∫–æ –∫—É–ø–∏–ª?!\n‚Äî –¢–∞–∫ —è–π—Ü–∞ –∂–µ –±—ã–ª–∏!",
    "–¢—Ä–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–∞ –∏–¥—É—Ç –≤ –±–∞—Ä. –ü–µ—Ä–≤—ã–π –∑–∞–∫–∞–∑—ã–≤–∞–µ—Ç –ø–∏–≤–æ. –í—Ç–æ—Ä–æ–π —Ç–æ–∂–µ –∑–∞–∫–∞–∑—ã–≤–∞–µ—Ç –ø–∏–≤–æ. –¢—Ä–µ—Ç–∏–π –∑–∞–∫–∞–∑—ã–≤–∞–µ—Ç –ø–∏–≤–æ.\n–ë–∞—Ä–º–µ–Ω: ¬´–£ –≤–∞—Å —á—Ç–æ, —Ç–æ–ª—å–∫–æ –æ–¥–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è?¬ª",
    "‚Äî –°–∫–æ–ª—å–∫–æ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–æ–≤ –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã –≤–∫—Ä—É—Ç–∏—Ç—å –ª–∞–º–ø–æ—á–∫—É?\n‚Äî –ù–∏ –æ–¥–Ω–æ–≥–æ. –≠—Ç–æ –∞–ø–ø–∞—Ä–∞—Ç–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞!",
  ],
  it: [
    "–í –æ—Ñ–∏—Å–µ:\n‚Äî –£ –º–µ–Ω—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç!\n‚Äî –ê –≤—ã —Ä–æ—É—Ç–µ—Ä –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–ª–∏?\n‚Äî –î–∞.\n‚Äî –ê –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.\n–ò–Ω—Ç–µ—Ä–Ω–µ—Ç –∑–∞—Ä–∞–±–æ—Ç–∞–ª.",
    "99 –º–∞–ª–µ–Ω—å–∫–∏—Ö –±–∞–≥–æ–≤ –≤ –∫–æ–¥–µ,\n99 –º–∞–ª–µ–Ω—å–∫–∏—Ö –±–∞–≥–æ–≤.\n–û–¥–∏–Ω –∏—Å–ø—Ä–∞–≤–∏–ª, –∫–æ–º–º–∏—Ç –∑–∞–ø—É—à–∏–ª,\n127 –º–∞–ª–µ–Ω—å–∫–∏—Ö –±–∞–≥–æ–≤ –≤ –∫–æ–¥–µ!",
    "–¢–µ—Å—Ç–∏—Ä–æ–≤—â–∏–∫ –∑–∞—Ö–æ–¥–∏—Ç –≤ –±–∞—Ä.\n–ó–∞–∫–∞–∑—ã–≤–∞–µ—Ç –ø–∏–≤–æ.\n–ó–∞–∫–∞–∑—ã–≤–∞–µ—Ç 0 –ø–∏–≤–∞.\n–ó–∞–∫–∞–∑—ã–≤–∞–µ—Ç 999999999 –ø–∏–≤–∞.\n–ó–∞–∫–∞–∑—ã–≤–∞–µ—Ç —è—â–µ—Ä–∏—Ü—É.\n–ó–∞–∫–∞–∑—ã–≤–∞–µ—Ç -1 –ø–∏–≤–æ.\n–ó–∞–∫–∞–∑—ã–≤–∞–µ—Ç NULL –ø–∏–≤–æ.\n–ó–∞–∫–∞–∑—ã–≤–∞–µ—Ç –ø–∏–≤–æ; DROP TABLE bar;",
    "‚Äî –ü–æ—á–µ–º—É –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç—ã –Ω–µ –ª—é–±—è—Ç –ø—Ä–∏—Ä–æ–¥—É?\n‚Äî –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –±–∞–≥–æ–≤, –∞ debugger –Ω–µ—Ç.",
    "Backend-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫: ¬´–†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –º–æ–µ–π –º–∞—à–∏–Ω–µ¬ª ü§∑‚Äç‚ôÇÔ∏è\nDevOps: ¬´–¢–æ–≥–¥–∞ –æ—Ç–ø—Ä–∞–≤–∏–º —Ç–≤–æ—é –º–∞—à–∏–Ω—É –≤ –ø—Ä–æ–¥–∞–∫—à–Ω¬ª",
  ],
  life: [
    "‚Äî –î–æ–∫—Ç–æ—Ä, —è –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç, —É –º–µ–Ω—è –¥–µ–ø—Ä–µ—Å—Å–∏—è.\n‚Äî –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—ã–π—Ç–∏ –Ω–∞ —É–ª–∏—Ü—É.\n‚Äî –Ø –ø—Ä–æ–±–æ–≤–∞–ª, –Ω–æ —Ç–∞–º –Ω–µ—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞.",
    "–ñ–µ–Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–∞:\n‚Äî –ú–∏–ª—ã–π, –¥–∞–≤–∞–π –∫—É–¥–∞-–Ω–∏–±—É–¥—å —Å—Ö–æ–¥–∏–º!\n‚Äî –•–æ—Ä–æ—à–æ, –æ—Ç–∫—Ä—ã–≤–∞–π –Ω–æ–≤—ã–π —Ç–∞–±.",
    "–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç –ª–æ–∂–∏—Ç—Å—è —Å–ø–∞—Ç—å –≤ 3 –Ω–æ—á–∏.\n–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç –ø—Ä–æ—Å—ã–ø–∞–µ—Ç—Å—è –≤ 11 —É—Ç—Ä–∞.\n‚Äî –û—Ç–ª–∏—á–Ω–æ! –¶–µ–ª—ã—Ö 8 —á–∞—Å–æ–≤ —Å–Ω–∞!\n*—Å–º–æ—Ç—Ä–∏—Ç –Ω–∞ —á–∞—Å—ã*\n‚Äî –û–π, —ç—Ç–æ PM...",
    "‚Äî –ü–æ—á–µ–º—É –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–æ—á—å—é?\n‚Äî –ü–æ—Ç–æ–º—É —á—Ç–æ:\n1) –ù–∏–∫—Ç–æ –Ω–µ –æ—Ç–≤–ª–µ–∫–∞–µ—Ç\n2) –ù–∏–∫—Ç–æ –Ω–µ –≤–∏–¥–∏—Ç —Ç–≤–æ–∏—Ö —Å–ª—ë–∑\n3) –ö–æ—Ñ–µ –ø–æ—Å–ª–µ –ø–æ–ª—É–Ω–æ—á–∏ ‚Äî —ç—Ç–æ —É–∂–µ –∑–∞–≤—Ç—Ä–∞–∫",
    "–î–µ–≤—É—à–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç—É:\n‚Äî –¢—ã –º–µ–Ω—è –ª—é–±–∏—à—å?\n‚Äî return true;\n‚Äî –≠—Ç–æ –Ω–µ —Ç–æ —á—Ç–æ —è —Ö–æ—Ç–µ–ª–∞ —É—Å–ª—ã—à–∞—Ç—å...\n‚Äî –ê —á—Ç–æ –Ω–µ —Ç–∞–∫? –§—É–Ω–∫—Ü–∏—è –∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç!",
  ],
  dark: [
    "‚Äî –†–µ–∫—É—Ä—Å–∏—è ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –≤—ã —Å–º–æ—Ç—Ä–∏—Ç–µ –≤ –∑–µ—Ä–∫–∞–ª–æ.\n‚Äî –ê —á—Ç–æ —è —Ç–∞–º —É–≤–∏–∂—É?\n‚Äî –†–µ–∫—É—Ä—Å–∏—è ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –≤—ã —Å–º–æ—Ç—Ä–∏—Ç–µ –≤ –∑–µ—Ä–∫–∞–ª–æ...",
    "–û–ø—Ç–∏–º–∏—Å—Ç: —Å—Ç–∞–∫–∞–Ω –Ω–∞–ø–æ–ª–æ–≤–∏–Ω—É –ø–æ–ª–æ–Ω.\n–ü–µ—Å—Å–∏–º–∏—Å—Ç: —Å—Ç–∞–∫–∞–Ω –Ω–∞–ø–æ–ª–æ–≤–∏–Ω—É –ø—É—Å—Ç.\n–ü—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç: —Å—Ç–∞–∫–∞–Ω –≤ –¥–≤–∞ —Ä–∞–∑–∞ –±–æ–ª—å—à–µ, —á–µ–º –Ω—É–∂–Ω–æ.",
    "–†–∞–Ω—å—à–µ: ¬´–ù–µ –≤–µ—Ä—å –≤—Å–µ–º—É, —á—Ç–æ –ø–∏—à—É—Ç –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ¬ª ‚Äî –ê–≤—Ä–∞–∞–º –õ–∏–Ω–∫–æ–ª—å–Ω, 1863\n–°–µ–π—á–∞—Å: *–≤–µ—Ä–∏—Ç –≤—Å–µ–º—É –∏–∑ ChatGPT*",
    "‚Äî –Ø –∑–Ω–∞—é SQL!\n‚Äî –û—Ç–ª–∏—á–Ω–æ! –ù–∞–ø–∏—à–∏ –∑–∞–ø—Ä–æ—Å.\n‚Äî SELECT * FROM knowledge WHERE topic = 'SQL';\n‚Äî –ò —á—Ç–æ –æ–Ω –≤–µ—Ä–Ω—ë—Ç?\n‚Äî NULL...",
    "–í —á—ë–º —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É Java –∏ JavaScript?\n\n–û–¥–∏–Ω ‚Äî —ç—Ç–æ —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è.\n–î—Ä—É–≥–æ–π ‚Äî —Ç–æ–∂–µ —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è.\n\n–ê —Ç–µ–ø–µ—Ä—å –∑–∞–±—É–¥—å –≤—Å—ë, —á—Ç–æ –∑–Ω–∞–ª. –û–Ω–∏ –í–û–û–ë–©–ï –Ω–µ —Å–≤—è–∑–∞–Ω—ã.",
  ],
};

const categories = {
  general: { name: "üòÑ –û–±—â–∏–µ", emoji: "üòÑ" },
  it: { name: "üíª IT-—é–º–æ—Ä", emoji: "üíª" },
  life: { name: "ü§∑ –ò–∑ –∂–∏–∑–Ω–∏", emoji: "ü§∑" },
  dark: { name: "üåë –ß—ë—Ä–Ω—ã–π —é–º–æ—Ä", emoji: "üåë" },
};

export async function handleJokesCallback(ctx: BotContext) {
  const keyboard = new InlineKeyboard()
    .text("üòÑ –û–±—â–∏–µ", "joke_general")
    .text("üíª IT-—é–º–æ—Ä", "joke_it").row()
    .text("ü§∑ –ò–∑ –∂–∏–∑–Ω–∏", "joke_life")
    .text("üåë –ß—ë—Ä–Ω—ã–π —é–º–æ—Ä", "joke_dark").row()
    .text("üé≤ –°–ª—É—á–∞–π–Ω—ã–π", "joke_random")
    .text("üîÑ –ï—â—ë", "joke_random").row()
    .text("‚óÄÔ∏è –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é", "back_to_menu");

  await ctx.editMessageText(
    `=============================
   üòÇ <b>–ê–ù–ï–ö–î–û–¢–´ –ò –®–£–¢–ö–ò</b> üòÇ
=============================

<b>üé≠ –ü–æ–¥–Ω–∏–º–∏ —Å–µ–±–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ!</b>

-----------------------------
<b>üìö –ö–ê–¢–ï–ì–û–†–ò–ò</b>
-----------------------------

üòÑ <b>–û–±—â–∏–µ</b>
   ‚Ä¢ –ö–ª–∞—Å—Å–∏–∫–∞ —é–º–æ—Ä–∞
   ‚Ä¢ –î–ª—è –≤—Å–µ—Ö –≤–æ–∑—Ä–∞—Å—Ç–æ–≤
   ‚Ä¢ –í—Å–µ–≥–¥–∞ –∞–∫—Ç—É–∞–ª—å–Ω–æ

üíª <b>IT-—é–º–æ—Ä</b>
   ‚Ä¢ –î–ª—è –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç–æ–≤
   ‚Ä¢ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —à—É—Ç–∫–∏
   ‚Ä¢ –ü–æ–π–º—É—Ç —Å–≤–æ–∏

ü§∑ <b>–ò–∑ –∂–∏–∑–Ω–∏</b>
   ‚Ä¢ –ë—ã—Ç–æ–≤—ã–µ —Å–∏—Ç—É–∞—Ü–∏–∏
   ‚Ä¢ –†–µ–∞–ª—å–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–∏
   ‚Ä¢ –£–∑–Ω–∞–µ—à—å —Å–µ–±—è

üåë <b>–ß—ë—Ä–Ω—ã–π —é–º–æ—Ä</b>
   ‚Ä¢ –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–π —é–º–æ—Ä
   ‚Ä¢ –ù–µ –¥–ª—è –≤—Å–µ—Ö
   ‚Ä¢ –ù–∞ —Å–≤–æ–π —Å—Ç—Ä–∞—Ö –∏ —Ä–∏—Å–∫

-----------------------------

üé≤ <b>–°–ª—É—á–∞–π–Ω—ã–π</b> ‚Äî —Å—é—Ä–ø—Ä–∏–∑!
üîÑ <b>–ï—â—ë</b> ‚Äî —Å–ª–µ–¥—É—é—â–∏–π

-----------------------------

üòÑ <b>–°–º–µ—Ö –ø—Ä–æ–¥–ª–µ–≤–∞–µ—Ç –∂–∏–∑–Ω—å!</b>

<b>üëá –í—ã–±–µ—Ä–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—é</b>`,
    {
      parse_mode: "HTML",
      reply_markup: keyboard,
    }
  );
  await ctx.answerCallbackQuery();
}

async function showJoke(ctx: BotContext, category: string) {
  const categoryJokes = jokes[category];
  if (!categoryJokes || categoryJokes.length === 0) {
    await ctx.answerCallbackQuery("‚ö†Ô∏è –®—É—Ç–∫–∏ —Å–∫–æ—Ä–æ!");
    return;
  }

  const joke = categoryJokes[Math.floor(Math.random() * categoryJokes.length)];
  const categoryInfo = categories[category as keyof typeof categories];

  const keyboard = new InlineKeyboard()
    .text(`üîÑ –ï—â—ë ${categoryInfo.emoji}`, `joke_${category}`)
    .text("üé≤ –°–ª—É—á–∞–π–Ω—ã–π", "joke_random").row()
    .text("üìö –í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏", "menu_jokes")
    .text("‚óÄÔ∏è –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é", "back_to_menu");

  await ctx.editMessageText(
    `=============================
 ${categoryInfo.emoji} <b>${categoryInfo.name.toUpperCase()}</b>
=============================

${joke}

-----------------------------

üòÇ <b>–ü–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å?</b>

<b>üëá –•–æ—á–µ—à—å –µ—â—ë?</b>`,
    {
      parse_mode: "HTML",
      reply_markup: keyboard,
    }
  );
  await ctx.answerCallbackQuery();
}

export async function handleJokeGeneral(ctx: BotContext) {
  await showJoke(ctx, "general");
}

export async function handleJokeIT(ctx: BotContext) {
  await showJoke(ctx, "it");
}

export async function handleJokeLife(ctx: BotContext) {
  await showJoke(ctx, "life");
}

export async function handleJokeDark(ctx: BotContext) {
  await showJoke(ctx, "dark");
}

export async function handleJokeRandom(ctx: BotContext) {
  const allCategories = Object.keys(jokes);
  const randomCategory =
    allCategories[Math.floor(Math.random() * allCategories.length)];
  await showJoke(ctx, randomCategory);
}
